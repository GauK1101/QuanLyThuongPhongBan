<Window x:Class="QuanLyThuongPhongBan.Views.EditProjectRewardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:QuanLyThuongPhongBan.CLass"
        mc:Ignorable="d"
        Title="EditProjectRewardWindow" Height="450" Width="800">

    <Window.Resources>
        <local:CurrencyConverter x:Key="CurrencyConverter"/>
    </Window.Resources>

    <StackPanel Margin="10">

        <!-- Checkbox để mở/tắt toàn bộ expand -->
        <CheckBox x:Name="chkExpandAll" Content="Mở tất cả chi tiết"
                  Margin="0,0,0,10"
                  Checked="chkExpandAll_Checked"
                  Unchecked="chkExpandAll_Unchecked"/>

        <!-- DataGrid cha -->
        <DataGrid x:Name="dgMaster" AutoGenerateColumns="False"
                  ItemsSource="{Binding ThuongDuAns}"
                  RowDetailsVisibilityMode="VisibleWhenSelected"
                  IsReadOnly="True"
                  Margin="10">
            <!-- Cột cha -->
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="80"/>
                <DataGridTextColumn Header="Giá Trị Hợp Đồng" Binding="{Binding GiaTriHopDong, Converter={StaticResource CurrencyConverter}}" Width="120"/>
                <DataGridTextColumn Header="Quyết Toán" Binding="{Binding QuyetToan, Converter={StaticResource CurrencyConverter}}" Width="120"/>
                <DataGridTextColumn Header="Tỉ Lệ Thưởng" Binding="{Binding TiLeThuongPhongBan, StringFormat={}{0}%}" Width="120"/>
                <DataGridTextColumn Header="Tổng Giá Trị Thưởng" Binding="{Binding TongGiaTriThuongPhongBan, Converter={StaticResource CurrencyConverter}}" Width="150"/>
                <DataGridTextColumn Header="Năm Thưởng" Binding="{Binding NamThuong}" Width="100"/>
            </DataGrid.Columns>

            <!-- RowDetails hiển thị DataGrid con -->
            <DataGrid.RowDetailsTemplate>
                <DataTemplate>
                    <DataGrid ItemsSource="{Binding Details}" IsReadOnly="True" AutoGenerateColumns="False" Margin="10,5,5,5">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Phòng Ban" Binding="{Binding IdPhongBan}" Width="100"/>
                            <DataGridTextColumn Header="Tỉ Lệ Thưởng" Binding="{Binding TiLeThuong, StringFormat={}{0}%}" Width="120"/>
                            <DataGridTextColumn Header="Giá Trị" Binding="{Binding GiaTri, Converter={StaticResource CurrencyConverter}}" Width="120"/>
                            <DataGridTextColumn Header="Điều Chỉnh Đợt 1" Binding="{Binding GiaTriDieuChinhDot1, Converter={StaticResource CurrencyConverter}}" Width="150"/>
                            <DataGridTextColumn Header="Tỉ Lệ Điều Chỉnh Đợt 1" Binding="{Binding TiLeDieuChinhDot1, StringFormat={}{0}%}" Width="180"/>
                            <DataGridTextColumn Header="Điều Chỉnh Đợt 2" Binding="{Binding GiaTriDieuChinhDot2, Converter={StaticResource CurrencyConverter}}" Width="150"/>
                            <DataGridTextColumn Header="Tỉ Lệ Điều Chỉnh Đợt 2" Binding="{Binding TiLeDieuChinhDot2, StringFormat={}{0}%}" Width="180"/>
                            <DataGridTextColumn Header="Thu Hồi Công Nợ" Binding="{Binding ThuHoiCongNo, Converter={StaticResource CurrencyConverter}}" Width="150"/>
                            <DataGridTextColumn Header="Nghiệm Thu" Binding="{Binding NghiemThu, Converter={StaticResource CurrencyConverter}}" Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DataTemplate>
            </DataGrid.RowDetailsTemplate>
        </DataGrid>
    </StackPanel>
</Window>
